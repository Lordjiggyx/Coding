import{a as t,b as n,l as i,d as a,e as r,f as e,g as o,m as s,h as m,i as l}from"./index-7c3a2ef8.js";import c,{PureComponent as f}from"react";import u from"prop-types";import h from"styled-components";import"./_curry2-12509879.js";import{C as p}from"./colors-fe7a2ec1.js";import"./path-f5ccb8a3.js";import"./_isString-9eecd9ee.js";import d from"classnames";import{ICON_CLASSNAME as g,Glyph as v}from"./icon.js";import{g as y}from"./attachClassName-14171279.js";import R from"uniqid";import k from"svg.js";var A={full:{front:[p.VIBRANT_CYAN,p.VIBRANT_CYAN],back:[p.VIBRANT_CYAN_DARK]},medium:{front:[p.RICH_PURPLE,p.RICH_PURPLE],back:[p.RICH_PURPLE_DARK]},low:{front:[p.VIBRANT_YELLOW,p.VIBRANT_YELLOW],back:[p.VIBRANT_YELLOW_DARK]},warning:{front:[p.RICH_RED,p.RICH_RED],back:[p.RICH_RED_DARK]}},E=function(t,n,i,a,r){for(var e=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"M0 0",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=t,m=0;m<180;m+=n)e+="L ".concat(m," ").concat(a(s)*i+o," "),s+=r;return"".concat(e," L").concat(180,", 34 L").concat(180,", ").concat(180," L1, ").concat(180," Z")};function w(){var t=a(["\n  display: inline-block;\n  position: relative;\n  &,\n  ."," {\n    max-width: 100%;\n    height: auto;\n  }\n  ."," {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: -4px;\n    bottom: 0;\n    width: 20%;\n    height: 15%;\n    margin: auto;\n    svg {\n      width: 100%;\n      height: 100%;\n    }\n  }\n"]);return w=function(){return t},t}var C=y({name:"BowlMainElement"}),_=y({name:"Bowl"}),b=h.div(w(),C,g),D=function(a){function u(){var t,n;r(this,u);for(var a=arguments.length,m=new Array(a),l=0;l<a;l++)m[l]=arguments[l];return n=e(this,(t=o(u)).call.apply(t,[this].concat(m))),i(s(n),"state",{key:0}),i(s(n),"reset",(function(){return n.setState({key:R()},n.runAnimation)})),i(s(n),"getColor",(function(t,i){var a=n.props.percent,r="full";return a<10?r="warning":a<25?r="low":a<60&&(r="medium"),new k.Color(A[r][t][i]).toHex()})),i(s(n),"createGradient",(function(t,i,a){var r,e,o=n.props.animationDuration,s=n.svgFillEl.gradient("radial",(function(n){r=n.at(0,t),e=n.at(1,i)}));return s.from(.8,0).to(0,0).radius(1.5),o?(r.animate(o).update(0,n.getColor(a,0)),e.animate(o).update(1,n.getColor(a,1))):(r.update(0,n.getColor(a,0)),e.update(1,n.getColor(a,1))),s})),i(s(n),"animate",(function(t,i,a,r,e,o,s){var m=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l="M0 ".concat(a(i)*r+m),c=E(i+=s,e,r,a,o,l);if(n[t].plot(c),n.animating){if("undefined"==typeof document)return;window.requestAnimationFrame((function(){return n.animate(t,i,a,r,e,o,s,m)}))}else n[t].animate(n.props.animationDuration/3,">").plot(E("frontFill"===t?1.8:.5,e,r,a,o))})),i(s(n),"animateCircles",(function(){n.circle1.animate(1e3).transform({x:5*Math.random(),y:5*Math.random()}),n.circle2.animate(1e3).transform({x:5*Math.random(),y:5*Math.random()}).after((function(){n.animating&&n.animateCircles()}))})),i(s(n),"displayIcon",(function(){return 0===n.props.percent})),n}return t(u,f),n(u,[{key:"componentDidMount",value:function(){this.runAnimation()}},{key:"componentDidUpdate",value:function(t){t.percent!==this.props.percent&&this.reset()}},{key:"runAnimation",value:function(){var t=this;if(k&&!this.displayIcon()&&!process.env.STORYBOOK_LOKI_BUILD){this.animating=!1;var n=this.props,i=n.animationDuration,a=n.percent,r=2*Math.PI/300*10,e=function(t){return.7*Math.sin(4*t+7)+2*Math.sin(.9*t)+3*Math.sin(2*t)+1*Math.sin(2*t+7)},o=10*Math.random(),s=Math.random()>.2,m=Math.random()-.5;m=m>0?(m+.3)/40:(m-.3)/40,this.svgFillEl=k(this.fillWrapperRef);var l=this.svgFillEl.group();l.transform({x:0,y:0});var c=l.mask(),f=this.svgFillEl.circle(144).move(18,18);c.add(f),c.fill("#fff");var u=l.group();u.maskWith(c),this.transformGroup=u.group(),this.minimumHeight=14.4,this.totalHeight=1.6-this.minimumHeight/100,this.transformGroup.transform({y:this.minimumHeight}),i?(this.animating=!0,this.transformGroup.animate(i).transform({y:this.minimumHeight+(100-a)*this.totalHeight}).afterAll((function(){return t.animating=!1}))):this.transformGroup.transform({y:this.minimumHeight+(100-a)*this.totalHeight}),this.backFill=this.transformGroup.path(E(.5,10,1.3,e,r)),this.animating&&this.animate("backFill",o,e,1.3,10,r,s?-m:m),this.backFill.fill(this.createGradient(A.full.back[0],A.full.back[0],"back")),this.frontFill=this.transformGroup.path(E(1.8,10,1.3,e,r)),this.animating&&this.animate("frontFill",o+.3,e,1.3,10,r,2*m),this.frontFill.fill(this.createGradient(A.full.front[0],A.full.front[1],"front"));var h=l.group(),p=h.group();p.transform({x:108,y:54}),h.maskWith(c),this.circle1=p.circle(10).fill({color:"#fff",opacity:.3}).move(8,8),this.circle2=p.circle(6).fill({color:"#fff",opacity:.3}),i?(this.animating=!0,p.animate(i).transform({y:100-a+54}).afterAll((function(){a<25?p.animate(1e3).transform({y:180}).afterAll((function(){t.animating=!1})):t.animating=!1})),this.animateCircles()):p.transform({y:a<42?142-a+54:100-a+54})}}},{key:"render",value:function(){var t=this,n=this.props,i=(n.animationDuration,n.percent,n.width),a=n.className,r=m(n,["animationDuration","percent","width","className"]),e=this.state.key;return c.createElement(b,l({className:d(a,_)},r,{key:e}),c.createElement("svg",{width:"".concat(i,"px"),viewBox:"0 0 ".concat(180," ").concat(180),className:C},c.createElement("g",{ref:function(n){return t.fillWrapperRef=n}},c.createElement("g",null,c.createElement("circle",{stroke:"#DFDFE8",strokeWidth:4,cx:90,cy:90,r:80,fill:"#fff"})))),this.displayIcon()&&c.createElement(v,{name:"warningM",color:"richRed.base"}))}}]),u}();i(D,"propTypes",{animationDuration:u.number,percent:u.number,width:u.number,className:u.string}),i(D,"defaultProps",{animationDuration:3e3,percent:50,width:180,className:null});export default D;
